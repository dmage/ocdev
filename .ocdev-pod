#!/bin/bash -efu

usage() {
    echo "usage: $OCDEV_PROGNAME <command>"
    echo
    echo "Available commands:"
    echo "  build-image  Build openshift/origin-pod:latest Docker image"
}

pod_image() {
    cp "$OCDEV_ORIGIN_DOCKER_BINDIR/pod" ./pod
    printf >./Dockerfile "%s\n" \
        'FROM scratch' \
        'COPY pod /pod' \
        'USER 1001' \
        'ENTRYPOINT ["/pod"]'
}

ocdevpod-build-image() {
    cdpkg "$OCDEV_ORIGIN_PACKAGE"
    ocdev docker-build images/pod
    ocdevutil-build-image pod_image openshift/origin-pod:latest
}

ocdevutil-main "ocdevpodhelper-" "ocdevpod-" "$@"
